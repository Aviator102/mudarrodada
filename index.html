<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Jogo</title>
    <link rel="stylesheet" href="style.css"> <!-- Se você tiver um arquivo de CSS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> <!-- Usando jQuery para facilitar interações -->
</head>
<body>
    <header>
        <h1>Bem-vindo ao Jogo Aviator</h1>
        <p>Monitore a rodada e o valor em tempo real.</p>
    </header>

    <main>
        <section id="status">
            <h2>Status da Rodada</h2>
            <p id="rodada">Rodada: <span id="numero-rodada">1</span></p>
            <p id="valor">Valor: <span id="valor-rodada">-</span></p>
        </section>

        <section id="controle">
            <h3>Alterar Rodada</h3>
            <input type="number" id="nova-rodada" placeholder="Digite nova rodada" />
            <button onclick="alterarRodada()">Alterar</button>
        </section>

        <div id="mensagem"></div>
    </main>

    <footer>
        <p>&copy; 2024 Jogo Aviator. Todos os direitos reservados.</p>
    </footer>

    <script>
        // Função para atualizar o valor e a rodada no HTML
        function atualizarStatus(rodada, valor) {
            document.getElementById('numero-rodada').textContent = rodada;
            document.getElementById('valor-rodada').textContent = valor;
        }

        // Função para enviar a nova rodada para o backend (Flask)
        function alterarRodada() {
            const novaRodada = document.getElementById('nova-rodada').value;

            if (!novaRodada) {
                alert("Por favor, insira um número de rodada válido.");
                return;
            }

            // Enviar a nova rodada para o servidor (Flask) via fetch
            fetch('/alterar-rodada', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ rodada: novaRodada })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('mensagem').textContent = data.mensagem;
                document.getElementById('nova-rodada').value = '';
            })
            .catch(error => {
                console.error('Erro:', error);
            });
        }

        // Função para buscar os dados da rodada em tempo real
        function buscarStatus() {
            fetch('/status-rodada')
                .then(response => response.json())
                .then(data => {
                    atualizarStatus(data.rodada, data.valor);
                })
                .catch(error => console.error('Erro ao buscar status:', error));
        }

        // Atualizar o status da rodada a cada 5 segundos
        setInterval(buscarStatus, 5000);

        // Carregar o status inicial ao carregar a página
        window.onload = buscarStatus;
    </script>
</body>
</html>
